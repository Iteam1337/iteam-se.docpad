- var scripts = getBlock('scripts')
- var styles = getBlock('styles')
- var basename = document.relativeBase.split("/")[0]
- basename = basename !== "index" ? basename : ""
- var pages = getCollection('sektion').toJSON()
- var subpages = (!!document.subpages) ? getCollection(document.subpages) : {}
- subpages = !!subpages && !!subpages.toJSON ? subpages.toJSON() : []

//- Other Scripts
- scripts.add(["/scripts/vendor.js"])

//- User
- styles.add(["/styles/vendor.css","/styles/iteamse.css"])
- scripts.add(["/scripts/iteamse.js"])

!!! 5
html(lang="en", ng-app="iteamse")
  head

    // Meta
    meta(charset="utf-8")
    meta(http-equiv="content-type", content="text/html; charset=utf-8")

    //-
      Use the .htaccess and remove these lines to avoid edge case issues.
      More info: h5bp.com/i/378
    meta(http-equiv="X-UA-Compatible", content="IE=edge,chrome=1")

    //- Our site title and description
    title= getPreparedTitle()
    meta(name="description", content=getPreparedDescription())
    meta(name="keywords", content=getPreparedKeywords())
    meta(name="author", content=site.author || '')

    //- Output DocPad produced meta elements
    != getBlock('meta').toHTML()

    //- Mobile viewport optimized: h5bp.com/viewport
    meta(name="viewport", content="width=device-width")

    // Icons
    link(rel="shortcut icon", href="ico/favicon.ico")
    link(rel="apple-touch-icon-precomposed", sizes="144x144", href="ico/apple-touch-icon-144-precomposed.png")
    link(rel="apple-touch-icon-precomposed", sizes="114x114", href="ico/apple-touch-icon-114-precomposed.png")
    link(rel="apple-touch-icon-precomposed", sizes="72x72", href="ico/apple-touch-icon-72-precomposed.png")
    link(rel="apple-touch-icon-precomposed", href="ico/apple-touch-icon-57-precomposed.png")

    //- Shims: IE6-8 support of HTML5 elements
    //if lt IE 9
      script(async src="http://html5shim.googlecode.com/svn/trunk/html5.js")

    // Styles
    != styles.toHTML()

  body(class=document.slug, ng-controller="MainCtrl")

    .row-fluid#header
      ul.subnav
        div.subnav-inner
          each doc in pages
            if (doc.pageOrder >= 10)
              - var clazz = (document.url === doc.url || basename === doc.basename) ? 'active' : null
              a(href=doc.url, property="dc:title", class=clazz)= doc.title
          a(href="http://tfs.iteam.se", target="_blank", class="btn") Logga in

      .header-inner
        a.brand(href="/")
          img(src="/images/logo.png")
        ul.nav

          each doc in pages
            if (doc.pageOrder < 10)
              - clazz = (document.url === doc.url || basename === doc.basename) ? 'active' : null
                a(href=doc.url, property="dc:title", class=clazz)= doc.title

        .openMobileNav.visible-phone(ng-click="mobileNav = !mobileNav; subpages = null")
          .etp-menu

    if (!!document.subpages)
      #navSubpages
        .subpage-inner
          each subpage in subpages
            - active = (document.url === subpage.url) ? 'active' : null
            a(href=subpage.url, class=active)= (subpage.navigationTitle ? subpage.navigationTitle :subpage.title)

    ul#mobileNav(ng-show="mobileNav && subpages == null",ng-animate="'slide'")
      each doc, i in pages
        - clazz = (document.url === doc.url) ? 'active' : null
        - hasSubpage = (doc.subpages) ? i : null
        li(mobile-nav, data-subpage=hasSubpage)
          a(class=clazz, data-url=doc.url)= doc.title
          if (doc.subpages)
            .etp-thin-chevron-right
    #subpageWrap
      each doc, i in pages
        if (doc.subpages)
          - subId = "subpages == " + i
          ul.subpages(ng-show=subId, ng-animate="'slide-in'")
            li.back(ng-click="subpages = null")
              .etp-thin-chevron-left
              span Tillbaka
            each subpage in getCollection(doc.subpages).toJSON()
              li
                a(href=subpage.url)= subpage.title

    .container
      .row-fluid#content.content!= content

    #footer
      #address
        ul
          li.company Iteam Solutions AB
          li.address TegnÃ©rgatan 28, 113 59 STOCKHOLM
          li Telefon: 08-267090
          li Organisationsnr: 556551-6928
      #followUs
        a(href="https://www.facebook.com/IteamSolutions", target="_blank")
          .ets-c-facebook
        a(href="http://twitter.com/iteam1337", target="_blank")
          .ets-c-twitter
        a(href="http://instagram.com/iteam1337", target="_blank")
          .ets-instagram

    // Scripts
    != scripts.toHTML()
